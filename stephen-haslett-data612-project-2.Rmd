---
title: "Data 612 Project 2"
author: "Stephen Haslett"
date: "6/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(recommenderlab)
library(ggplot2)

set.seed(1)
data(MovieLense)
```

```{r, warning=FALSE, message=FALSE}
# User similarity.
similarity_users <- similarity(MovieLense[1:4, ], method = 'cosine', which = 'users')
similarity_users <- as.matrix(similarity_users)
similarity_users
image(similarity_users, main = 'User similarity')
```


```{r, warning=FALSE, message=FALSE}
# Item similarity.
similarity_items <- similarity(MovieLense[, 1:4], method = 'cosine', which = 'items')
similarity_items <- as.matrix(similarity_items)
similarity_items
image(similarity_items, main = 'Item similarity')
```



### Explore the data
```{r, warning=FALSE, message=FALSE}
ratings_vector <- as.vector(MovieLense@data)
# Remove empty values.
ratings_vector <- ratings_vector[ratings_vector != 0]
ratings_table <- table(ratings_vector)
ratings_table


```


```{r, warning=FALSE, message=FALSE}
ratings_vector <- factor(ratings_vector)
qplot(ratings_vector) + ggtitle('Distribution of Ratings')
```


###Views per movie.
```{r, warning=FALSE, message=FALSE}
views_per_movie <- colCounts(MovieLense)
views_table <- data.frame(
  movie = names(views_per_movie),
  views = views_per_movie
)

views_table <- views_table[order(views_table$views, decreasing = TRUE), ]
ggplot(views_table[1:6, ], aes(x = movie, y = views)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + ggtitle("Number of views of the top movies")

```


## Data Preperation
```{r, warning=FALSE, message=FALSE}
# Select only users who have rated at least 50 movies, and
# movies that have been watched at least 100 times.
movie_ratings <- MovieLense[rowCounts(MovieLense) > 50, colCounts(MovieLense) > 100]
movie_ratings
average_ratings_per_user <- rowMeans(movie_ratings)
average_ratings_per_user

```






